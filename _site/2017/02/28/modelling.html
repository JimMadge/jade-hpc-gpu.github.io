<!DOCTYPE html>
<html class="no-js">
  <head>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>From distributions to linear models</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

<!-- CSS -->
<link rel="stylesheet" href="/css/owl.carousel.css" />
<link rel="stylesheet" href="/css/bootstrap.min.css" />
<link rel="stylesheet" href="/css/font-awesome.min.css" />
<link rel="stylesheet" href="/css/airspace.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/ionicons.min.css" />
<link rel="stylesheet" href="/css/animate.css" />
<link rel="stylesheet" href="/css/responsive.css" />
<link rel="stylesheet" href="/css/syntax.css" />

<!-- Js -->
<script src="/js/vendor/modernizr-2.6.2.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/plugins.js"></script>
<script src="/js/min/waypoints.min.js"></script>
<script src="/js/jquery.counterup.js"></script>

<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js"></script>
<script src="/js/google-map-init.js"></script>


<script src="/js/main.js"></script>


  </head>
  <body>


    <!-- Header Start -->
<header>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <!-- header Nav Start -->
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://jade.github.io/">
              <img src="/img/jade-logo.png" alt="Logo">
            </a>
          </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav navbar-right">
                <li><a href="/">Home</a></li>
               <!-- <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="http://localhost:4000//blog">Blog</a></li>-->
                <li><a href="http://localhost:4000//consortium">Consortium</a></li>
                <li><a href="http://localhost:4000//access">Access</a></li>
                <li><a href="http://localhost:4000//news">News and Events</a></li>
                <li><a href="http://localhost:4000//support">Support</a></li>
                <li><a href="http://localhost:4000//links">Useful links</a></li>
                <!--<li><a href="/contact">Contact</a></li>-->
              </ul>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
    </div>
  </div>
</header><!-- header close -->



    <div class="post">
  <!-- Wrapper Start -->
  <section id="intro" style="border: 1px dotted #ddd;">
    <div class="container">
      <div class="row">
        <div>
          <div class="block">
            <h1>From distributions to linear models</h1>
            <div class="post-info-wrapper">
              <p class="italic">By <span class="bold">Gergana</span> on <span class="bold">February 28, 2017</span></p>
            </div>
            <hr />
            <p><div class="block">
	<center>
		<img src="/img/tutheaderlm.png" alt="Img" />
	</center>
</div>

<h3 id="tutorial-aims">Tutorial Aims:</h3>

<h4 id="-1-get-familiar-with-different-data-distributions"><a href="#distributions"> 1. Get familiar with different data distributions</a></h4>

<h4 id="-2-practice-linear-models"><a href="#linear"> 2. Practice linear models</a></h4>

<h4 id="-2-practice-generalised-linear-models"><a href="#generalised"> 2. Practice generalised linear models</a></h4>

<p>As you are setting out to answer your research questions, often you might want to know what is the effect of X on Y, how does X change with Y, etc. The answer to “What statistical analysis are you going to use?” will probably be a model of some sort. A model in its simplest forms looks like:</p>

<p><code class="highlighter-rouge">temp.m &lt;- lm(soil.temp ~ elevation)</code> - i.e. we are trying to determine the effect of elevation on soil temperature.</p>

<p>A slightly more complicated model might look like: <code class="highlighter-rouge">skylark.m &lt;- lm(abundance ~ treatment + farm.area, family = poisson, data = skylarks)</code> - here you are modelling <code class="highlighter-rouge">abundance</code>, the response variable, as a function of <code class="highlighter-rouge">treatment</code> (e.g. a categorical variable describing different types of farms) and <code class="highlighter-rouge">farm.area</code> (i.e. the size of each farm on which abundance data were collected) - those are your explanatory variables. The <code class="highlighter-rouge">family</code> argument refers to the distribution of the data, in this case <code class="highlighter-rouge">abundance</code> represents count zero-inflated data, for which a Poisson distribution is suitable. The <code class="highlighter-rouge">data</code> argument refers to the dataframe from which the variables we are studying come.</p>

<p>We will talk more about different data distributions later, until then, <strong>go to <a href="https://github.com/ourcodingclub/CC-8-Modelling" target="_blank">the repository for this tutorial</a>, fork it to your own Github account, clone the repository on your computer and start a version-controlled project in RStudio. For more details on how to do this, please check out our <a href="https://ourcodingclub.github.io/2017/02/27/git.html" target="_blank"> Intro to Github for version control</a> tutorial.</strong></p>

<p>Here is a brief summary of the data distributions you might encounter most often.</p>

<h3 id="different-data-distributions">Different data distributions</h3>

<p><a name="distributions"></a></p>

<h4 id="gaussian---continuous-data-normal-distribution-and-homoscedasticity-provided"><strong>Gaussian</strong> - Continuous data (normal distribution and homoscedasticity provided)</h4>
<h4 id="poisson---count-abundance-data-integer-values-zero-inflated-data-left-skewed-data"><strong>Poisson</strong> - Count abundance data (integer values, zero-inflated data, left-skewed data)</h4>
<h4 id="binomial---binary-variables-true--false-01-presence--absence-data"><strong>Binomial</strong> - Binary variables (TRUE / FALSE, 0/1, presence / absence data)</h4>

<p>Choosing the right distribution for your analysis is an important step about which you should think carefully - it could be frustrating to spend tons of time running models, plotting their results and writing them up only to realise that all along you should have used e.g. a Poisson distribution instead of a Gaussian one.</p>

<p>Another important to consider aspect of modelling is how many terms, i.e. explanatory variables, you want your model to include. It’s a good idea to draft out your model structure before you have started thinking about exactly which R packages you will use, running different types of models, etc. Think about what it is you want to examine and what are the potential confounding variables, i.e. what else might influence your response variable, aside from the explanatory variable you are most interested in? Here is an example model structure:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">skylark.m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">abundance</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">treatment</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">farm.area</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">latitude</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">longitude</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">visits</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Here we are chiefly interested in the effect of treatment - does skylark abundance vary between the different farm treatments? This is the research question we might have set out to answer, but we still need to acknowledge that farm treatment type is not the only factor influencing abundance. Based on our ecological understanding, we can select other potentially confounding variables - for example skylark abundance will most likely be higher on larger farms - we need to account for that. Additionally, where farms are located might have an effect, thus we are adding <code class="highlighter-rouge">latitude + longitude</code>. Imagine your experimental design didn’t go exactly as you planned - you meant to visit all farms three times to collect data, but some farms you managed to visit only twice. Ignoring this would weaken your final results - is abundance different / the same because the treatment has no / an effect, or because there were differences in study effort? To test that, you can include a <code class="highlighter-rouge">visits</code> term examining the effect of number on visits on abundance. Some might say this model is very complex, and they would be right - there are a lot of terms in it! A simple model is usually prefered to a complex model, but if you have strong reasons for including a term in your model, then it should be there. So think carefully about your model structure - once you know the variables whose effects you want to study, and the variables whose effects you might need to account for, you can move onto running your models.</p>

<p>If your model has a lot of variables, you are also in danger of <strong>overfitting</strong> - meaning that you have many variables, but there simply is not enough variation in your data set to account for including all of them. Overfitting can cast doubt over your model’s output, so think carefully about the structure of your model</p>

<p>We will now explore a few different types of models.</p>

<p><a name="linear"></a></p>

<h3 id="practicing-linear-models">Practicing linear models</h3>

<p>Open the <code class="highlighter-rouge">Modelling_script.R</code> file and add in your details. We will start by working with a sample dataset about apple yield in relation to different factors. The dataset is part of the <code class="highlighter-rouge">agridat</code> package.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"agridat"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">agridat</span><span class="p">)</span><span class="w">

</span><span class="c1"># Loading the dataset from agridat
</span><span class="n">apples</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">agridat</span><span class="o">::</span><span class="n">archbold.apple</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">apples</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">apples</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>
<p>Check out the dataset. Before we run our model, it’s a good idea to visualise the data just to get an idea of what to expect. We can make a boxplot for this purpose. We can examine the effect of spacing on apple yield - we can hypothesise that the closer apples are to other apples, the more they compete for resources, thus reducing their yield. Ideally, we would have sampled yield from many orchards where the trees were planted at different distances from one another - from the summary of the dataset you can see that there are only three <code class="highlighter-rouge">spacing</code> categories - 6, 10 and 14 m, it would be a bit of a stretch to count three numbers as a continuous variable, so let’s make them a factor instead. This turns the previously numeric <code class="highlighter-rouge">spacing</code> variable into a 3-level categorical variable, with 6, 10 and 14 being its levels.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">apples</span><span class="o">$</span><span class="n">spacing2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">apples</span><span class="o">$</span><span class="n">spacing</span><span class="p">)</span><span class="w">

</span><span class="p">(</span><span class="n">apples.p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">apples</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">spacing2</span><span class="p">,</span><span class="w"> </span><span class="n">yield</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#CD3333"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#8B2323"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme.clean</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">  
    </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Spacing (m)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Yield (kg)"</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<center><img src="/img/apples2.png" alt="Img" style="width: 700px;" /></center>

<p>From our boxplot we can see that yield is pretty similar across the different spacing distances - even though there is a trend towards higher yield at higher spacing, the error bars almost completely overlap. From looking at this boxplot alone, one might image our hypothesis of higher yield at higher spacing not being supported. Let’s run a model to explicitly test this.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">apples.m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">yield</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">spacing2</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apples</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">apples.m</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>
<p>Check out the summary output of our model:</p>

<center><img src="/img/output.png" alt="Img" style="width: 800px;" /></center>

<p>Turns out that yield does significantly differ between the three spacing categories - we can reject the null hypothesis of no effect of spacing on apple yield. It looks like apple yield is indeed higher when the distance between trees is higher - this is in line with our original ecological thoughts - the further away trees are from one another, the less they are limiting each others growth. But let’s take a look at a few other things from the summary output. Notice how because <code class="highlighter-rouge">spacing2</code> is a factor, you get results for <code class="highlighter-rouge">spacing210</code>, <code class="highlighter-rouge">spacing214</code>. If you are looking for the <code class="highlighter-rouge">spacing26</code> category, that is the intercept - R just picks the first category in an alphabetical order and makes that one the intercept. You also get a <code class="highlighter-rouge">Multiple R-squared</code> value, and an <code class="highlighter-rouge">Adjusted R-squared</code> value. These values refer to how much of the variation in the <code class="highlighter-rouge">yield</code> variable is explained by our predictor <code class="highlighter-rouge">spacing2</code> - the values go from 0 to 1, with 1 meaning that our model variables explain 100% of the variation in the examined variable. <code class="highlighter-rouge">R-squared</code> values tend to increase as you add more terms to your model, but you also need to account for overfitting - the <code class="highlighter-rouge">Adjusted R-squared</code> value takes into account how many terms your model has, and how many data points are available in the response variable. From looking at our <code class="highlighter-rouge">R-squared</code> values, this is not a great model, which makes sense - imagine all the other things that could have an impact on yield that we have not studied - fertilisation levels, weather conditions, water availability, etc.</p>

<p>In addition to checking whether this model makes sense from an ecological perspective, we should check that it actually meets the assumptions of a linear model:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">
</span><span class="c1"># Checking that the residuals are normally distributed
</span><span class="n">apples.resid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resid</span><span class="p">(</span><span class="n">apples.m</span><span class="p">)</span><span class="w">
</span><span class="n">shapiro.test</span><span class="p">(</span><span class="n">apples.resid</span><span class="p">)</span><span class="w">
</span><span class="c1"># Normal distribution
</span><span class="w">
</span><span class="c1"># Checking for homoscedasticity
</span><span class="n">bartlett.test</span><span class="p">(</span><span class="n">apples</span><span class="o">$</span><span class="n">yield</span><span class="p">,</span><span class="w"> </span><span class="n">apples</span><span class="o">$</span><span class="n">spacing2</span><span class="p">)</span><span class="w">
</span><span class="n">bartlett.test</span><span class="p">(</span><span class="n">yield</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">spacing2</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apples</span><span class="p">)</span><span class="w">  </span><span class="c1"># Note that these two ways of writing the code give the same results
# Homoscedasticity
</span></code></pre>
</div>

<p>Linear model assumptions are met (we can imagine that the data points are independent, since we didn’t collect the data, we can’t really know).</p>

<p>We can examine the model fit further by looking at a few plots:</p>
<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">apples.m</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>This will produce a set of four plots: residuals versus fitted values, a Q-Q plot of standardized residuals, a scale-location plot (square roots of standardized residuals versus fitted values, and a plot of residuals versus leverage that adds bands corresponding to Cook’s distances of 0.5 and 1. In general, looking at these plots can help you identify any outliers that have huge leverage, and confirm that your model has ran alright - e.g. you would want the data points on the Q-Q plot to follow the line.</p>

<h3 id="practicing-generalised-linear-models">Practicing generalised linear models</h3>

<p>The model we used above was a <strong>general</strong> linear model, since it met all the assumptions for one (normal distribution, homoscedasticity, etc.) Quite often in ecology and environmental science that is not the case, and then we use different data distributions. Here we will talk about a Poisson and a binomial distribution - to use them, we need to run <strong>generalised</strong> linear models.</p>

<h4 id="a-model-with-a-poisson-distribution">A model with a Poisson distribution</h4>

<p>Import the <code class="highlighter-rouge">shagLPI.csv</code> dataset and check it’s summary using <code class="highlighter-rouge">summary(shagLPI)</code> - notice that for some reason R has decided that year is a character variable, when it should instead be a numeric variable. Let’s fix that, so that we don’t run into trouble later. The data represent population trends for European Shags on the Isle of May, and are available from the <a href="http://www.livingplanetindex.org/home/index" target="_blank">Living Planet Index.</a></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">shag</span><span class="o">$</span><span class="n">year</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">shag</span><span class="o">$</span><span class="n">year</span><span class="p">)</span><span class="w">

</span><span class="c1"># Making a histogram to asses data distribution
</span><span class="n">shag.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">shag</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">pop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme.clean</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<center><img src="/img/poisson2.png" alt="Img" style="width: 700px;" /></center>

<p>Our <code class="highlighter-rouge">pop</code> variable represents count abundance data, i.e. integer values (whole European Shags!), so a Poisson distribution is appropriate. Often count abundance data are zero-inflated and skewed towards the right - here our data are not like that, but if they were, a Poisson distribution would still have been appropriate.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">shag.m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">pop</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poisson</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shag</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">shag.m</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>From the summary of our model we can see that European Shag abundance varies significantly based on the predictor <code class="highlighter-rouge">year</code>. Let’s visualise how European Shag abundance has changed through the years:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="p">(</span><span class="n">shag.p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">shag</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#483D8B"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#483D8B"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#483D8B"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1975</span><span class="p">,</span><span class="w"> </span><span class="m">1980</span><span class="p">,</span><span class="w"> </span><span class="m">1985</span><span class="p">,</span><span class="w"> </span><span class="m">1990</span><span class="p">,</span><span class="w"> </span><span class="m">1995</span><span class="p">,</span><span class="w"> </span><span class="m">2000</span><span class="p">,</span><span class="w"> </span><span class="m">2005</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme.clean</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">" "</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"European Shag abundance"</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<center><img src="/img/shag.png" alt="Img" style="width: 700px;" /></center>

<p><strong>Figure 1. European shag abundance on the Isle of May, Scotland, between 1970 and 2006.</strong> Points represent raw data and model fit represents a generalised linear model with 95% confidence intervals.</p>

<h4 id="a-model-with-a-binomial-distribution">A model with a binomial distribution</h4>

<p>We will now work this the <code class="highlighter-rouge">Weevil_damage.csv</code> data that you can import from your project’s directory. We can examine if damage to Scott’s pine by weevils (a binary, TRUE/FALSE variable) varies based on the block in which the trees were located. You can imagine that different blocks represent different Scott’s pine populations, perhaps some of them will be particularly vulnerable to weevils?</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Making block a factor (a categorical variable)
</span><span class="n">Weevil_damage</span><span class="o">$</span><span class="n">block</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">Weevil_damage</span><span class="o">$</span><span class="n">block</span><span class="p">)</span><span class="w">

</span><span class="c1"># Running the model
</span><span class="n">weevil.m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">damage_T_F</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Weevil_damage</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">weevil.m</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Check out the summary output - looks like the probability of a pine tree enduring damage from weevils does vary significantly based on the block in which the tree was located.</p>

<p><b> We have now covered the basics of modelling - in our next tutorial we will look at mixed effects models, which are used more and more within ecology and environmental science. Until then, you can check out a couple of other tutorials on modelling to further your knowledge:</b></p>

<p><a href="http://data.princeton.edu/R/linearModels.html" target="_blank"> General and generalised linear models, by Germán Rodríguez. </a></p>

<p><a href="http://tutorials.iq.harvard.edu/R/Rstatistics/Rstatistics.html" target="_blank"> Regression modelling in R, by Harvard University. </a></p>

<hr />

<hr />

<h4 id="check-out-our-useful-links-page-where-you-can-find-loads-of-guides-and-cheatsheets">Check out our <a href="https://ourcodingclub.github.io/links/" target="_blank">Useful links</a> page where you can find loads of guides and cheatsheets.</h4>

<h4 id="if-you-have-any-questions-about-completing-this-tutorial-please-contact-us-on-ourcodingclubgmailcom">If you have any questions about completing this tutorial, please contact us on ourcodingclub@gmail.com</h4>

<h4 id="we-would-love-to-hear-your-feedback-on-the-tutorial-whether-you-did-it-in-the-classroom-or-online">We would love to hear your feedback on the tutorial, whether you did it in the classroom or online:</h4>
<h4 id="httpswwwsurveymonkeycoukrnnrs98g"><a href="https://www.surveymonkey.co.uk/r/NNRS98G">https://www.surveymonkey.co.uk/r/NNRS98G</a></h4>

<ul class="social-icons">
	<li>
		<h3>
			<a href="https://twitter.com/our_codingclub" target="_blank">&nbsp;Follow our coding adventures on Twitter! <i class="fa fa-twitter"></i></a>
		</h3>
	</li>
</ul>

<h3 id="subscribe-to-our-mailing-list">  Subscribe to our mailing list:</h3>
<div class="container">
	<div class="block">
        <!-- subscribe form start -->
		<div class="form-group">
			<form action="https://getsimpleform.com/messages?form_api_token=de1ba2f2f947822946fb6e835437ec78" method="post">
			<div class="form-group">
				<input type="text" class="form-control" name="Email" placeholder="Email" required="" />
			</div>
			<div>
                        	<button class="btn btn-default" type="submit">Subscribe</button>
                    	</div>
                	</form>
		</div>
	</div>
</div>
</p>
          </div>
        </div><!-- .col-md-7 close -->
      </div>
    </div>
  </section>
</div>
<p class="center-text" style="padding: 30px;">
  <a href="/blog">Back to blog</a>
</p>











    <!-- footer Start -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="footer-manu">
          <ul>
            <li><a href="/consortium">About Us</a></li>
        <!--    <li><a href="/contact">Contact us</a></li>-->
          </ul>
        </div>
        <p>Content by <a href="/about/">..</a>.</p>
        <p>Copyright &copy; Design &amp; Developed by <a href="http://www.themefisher.com">Themefisher</a>. All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>

    

    </body>
</html>

