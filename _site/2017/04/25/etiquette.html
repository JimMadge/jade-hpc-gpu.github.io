<!DOCTYPE html>
<html class="no-js">
  <head>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Coding etiquette</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

<!-- CSS -->
<link rel="stylesheet" href="/css/owl.carousel.css" />
<link rel="stylesheet" href="/css/bootstrap.min.css" />
<link rel="stylesheet" href="/css/font-awesome.min.css" />
<link rel="stylesheet" href="/css/airspace.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/ionicons.min.css" />
<link rel="stylesheet" href="/css/animate.css" />
<link rel="stylesheet" href="/css/responsive.css" />
<link rel="stylesheet" href="/css/syntax.css" />

<!-- Js -->
<script src="/js/vendor/modernizr-2.6.2.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/plugins.js"></script>
<script src="/js/min/waypoints.min.js"></script>
<script src="/js/jquery.counterup.js"></script>

<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js"></script>
<script src="/js/google-map-init.js"></script>


<script src="/js/main.js"></script>


  </head>
  <body>


    <!-- Header Start -->
<header>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <!-- header Nav Start -->
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://jade.github.io/">
              <img src="/img/jade-logo.png" alt="Logo">
            </a>
          </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav navbar-right">
                <li><a href="/">Home</a></li>
               <!-- <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="http://localhost:4000//blog">Blog</a></li>-->
                <li><a href="http://localhost:4000//consortium">Consortium</a></li>
                <li><a href="http://localhost:4000//access">Access</a></li>
                <li><a href="http://localhost:4000//news">News and Events</a></li>
                <li><a href="http://localhost:4000//support">Support</a></li>
                <li><a href="http://localhost:4000//links">Useful links</a></li>
                <!--<li><a href="/contact">Contact</a></li>-->
              </ul>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
    </div>
  </div>
</header><!-- header close -->



    <div class="post">
  <!-- Wrapper Start -->
  <section id="intro" style="border: 1px dotted #ddd;">
    <div class="container">
      <div class="row">
        <div>
          <div class="block">
            <h1>Coding etiquette</h1>
            <div class="post-info-wrapper">
              <p class="italic">By <span class="bold">Gergana</span> on <span class="bold">April 25, 2017</span></p>
            </div>
            <hr />
            <p><div class="block">
	<center>
		<img src="/img/tutheaderet.png" alt="Img" />
	</center>
</div>

<h3 id="tutorial-aims">Tutorial Aims:</h3>

<h4 id="-1-organising-scripts-into-sections-"><a href="#sections"> 1. Organising scripts into sections </a></h4>

<h4 id="-2-following-a-coding-syntax-etiquette"><a href="#syntax"> 2. Following a coding syntax etiquette</a></h4>

<h4 id="-3-tidying-up-old-scripts-and-data-frames"><a href="#tidy"> 3. Tidying up old scripts and data frames</a></h4>

<p>The coding etiquette outlined in this tutorial is applicable to most analyses - here we will apply them to an analysis of vertebrate population change from a previous Coding Club tutorial on <a href="https://ourcodingclub.github.io/2017/03/20/seecc.html" target="_blank">Quantifying population change and visualising species occurrence.</a> You can download all the resources for the tutorial, including some helpful cheatsheets can be downloaded from <a href="https://github.com/ourcodingclub/SEECC-workshop">this repository</a> Clone and download the repo as a zipfile, then unzip and set the folder as your working directory with code, or click <code class="highlighter-rouge">Session/ Set Working Directory/ Choose Directory</code> from the RStudio menu.</p>

<p>Alternatively, you can fork <a href="https://github.com/ourcodingclub/SEECC-workshop">the repository</a> to your own Github account and then add it as a new RStudio project by copying the HTTPS/SSH link. For more details on how to register on Github, download Git, sync RStudio and Github and use version control, please check out our previous <a href="https://ourcodingclub.github.io/2017/02/27/git.html" target="_blank">tutorial.</a></p>

<p><strong>Start downloading the files from the GitHub repo now, so that the download has finished by the time you need them. We will go through the coding etiquette first, so there is no need for you to open anything from the downloaded files at this stage. You can copy across code from this tutorial into a blank script file for practice, or you can edit your own script. Alternatively, you can read through the tips shared here, then go to the tutorial on <a href="https://ourcodingclub.github.io/2017/03/20/seecc.html" target="_blank">Quantifying population change and visualising species occurrence</a>, and follow the tutorial whilst applying the coding etiquette outlined here.</strong></p>

<p><a name="sections"></a></p>

<h3 id="1-organising-scripts-into-sections">1. Organising scripts into sections</h3>

<p>Once you start analysing your data in <code class="highlighter-rouge">R</code>, the lines of code can quickly pile up - hundreds of lines to scroll through, numerous objects whose names might make sense to you, but not to other people or future you. This tutorial will offer tips on how to make your code easy to read, understand and use by you and everyone who might ever need to check out your code. Following a coding etiquette (a set of “rules” you follow consistently throughout your work) will improve your <code class="highlighter-rouge">R</code> workflow, as well as reduce the amount of errors arising from accidental overwriting of objects, typos when referring to objects called like <code class="highlighter-rouge">MyData_new.clean</code> and similar small issues that might end up causing big frustrations.</p>

<p>As with any piece of writing, it really helps to have a clear structure to your script. A script is a <code class="highlighter-rouge">.R</code> file that contains your code - you could directly type code into the R console, but that way you have no record of it, and you won’t be able to reuse it later. To make a new <code class="highlighter-rouge">.R</code> file, go to <code class="highlighter-rouge">File/New file/R script</code>. For more information on the general <code class="highlighter-rouge">RStudio</code> layout, you can check out our <a href="https://ourcodingclub.github.io/2016/11/13/intro-to-r.html" target="_blank">Intro to RStudio tutorial</a>. <strong>A clearly structured script allows both the writer and the reader to easily navigate through the code, and it means that we can easily find what we need - for example if we want to know what packages are used, we would go to the <code class="highlighter-rouge">Libraries</code> section.</strong></p>

<p><code class="highlighter-rouge">RStudio</code> has a very useful feature allowing you to see an outline of your script, similar to when using <code class="highlighter-rouge">Microsoft Word</code>. Now that you have made a new (blank) script file, you might notice a little outline icon in the top right corner of the script. If you click on it, you will see your outline - currently it is blank since we haven’t added any code, but once we start creating sections, you will see them appear here. You can then click on the section you wish to view, and you are automatically taken to that part of the script. No more endless scrolling!</p>

<center> <img src="/img/outline.png" alt="Img" style="width: 800px;" /> </center>

<p>To create sections, first you need to add a comment using the <code class="highlighter-rouge">#</code> symbol. Comments are incredibly useful for making sense of code and clarifying what you are doing, and why you are doing it. Once you have a comment statement, like <code class="highlighter-rouge"># Testing comments</code>, you can add four or more <code class="highlighter-rouge">#</code> or <code class="highlighter-rouge">-</code> to make that comment the start of a section, for example <code class="highlighter-rouge"># Testing comments ----</code>. In your outline you will see this comment as your first section.</p>

<h4 id="commenting-guidelines">Commenting guidelines:</h4>

<p><strong>Each line of a comment should begin with the comment symbol <code class="highlighter-rouge">#</code> and a single space</strong>. Comments should be concise to avoid having to scroll a lot to read them in full, and most importantly, they should be informative enough so that you and your collaborators can understand what you are doing and why you are doing it.</p>

<p>If you are commenting inline with code, place  <strong>two spaces</strong> after the code, followed by <code class="highlighter-rouge">#</code>, a <strong>single space</strong> and then your text, e.g. <code class="highlighter-rouge">summary(model)&lt;space&gt;&lt;space&gt;#&lt;space&gt;comment</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Calculating summary statistics for each biome in the Living Planet Index database
# You will do this later in the LPI tutorial, no need to run the code now, this just illustrates comments
</span><span class="n">LPI_biome_summ</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">LPI_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">biome</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Group by biome
</span><span class="w">  </span><span class="n">summarise</span><span class="p">(</span><span class="n">populations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">(),</span><span class="w">   </span><span class="c1"># Create columns, number of populations
</span><span class="w">            </span><span class="n">mean_study_length_years</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">lengthyear</span><span class="p">),</span><span class="w">  </span><span class="c1"># mean study length
</span><span class="w">            </span><span class="n">max_lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">decimal_latitude</span><span class="p">),</span><span class="w">  </span><span class="c1"># max latitude
</span><span class="w">            </span><span class="n">min_lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">decimal_latitude</span><span class="p">),</span><span class="w">  </span><span class="c1"># max longitude
</span><span class="w">            </span><span class="n">dominant_sampling_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">which.max</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">sampling_method</span><span class="p">))),</span><span class="w">  </span><span class="c1"># modal sampling method
</span><span class="w">            </span><span class="n">dominant_units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">which.max</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">units</span><span class="p">))))</span><span class="w">  </span><span class="c1"># modal unit type
</span></code></pre>
</div>

<h4 id="script-structure">Script structure:</h4>

<p><strong>There are no strict rules and you can adapt the number and names of sections to your needs, but in general a script includes the following sections:</strong></p>

<p><strong>Introductory section</strong> - author statement (what does this script do?), author(s) names, contact details and date.</p>

<p><strong>Libraries</strong> - what packages are you using for this script? Keep all of them together at the start of your script. When switching between scripts, with your packages already loaded, it’s easy to forget to copy across the library, which means future you might get confused as to why the code isn’t working anymore. Your library will be extra informative to you and other people if you add in comments about what you are using each package for.</p>

<p><strong>Here are two examples, good and bad, to illustrate the aforementioned sections.</strong></p>

<p><strong>A not particularly useful start of a script:</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># My analysis
</span></code></pre>
</div>

<p><strong>A more informative start of a script:</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Analysing vertebrate population change based on the Living Planet Index
# Data available from http://www.livingplanetindex.org/
</span><span class="w">
</span><span class="c1"># Gergana Daskalova ourcodingclub@gmail.com
# 25-04-2017
</span><span class="w">
</span><span class="c1"># Libraries ----
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w">  </span><span class="c1"># Formatting data for analysis
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">  </span><span class="c1"># Manipulating data
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">  </span><span class="c1"># Visualising results
</span></code></pre>
</div>

<p><strong>Functions</strong> - are you using any functions written by you and/or others? Define them here. For example functions to remove <code class="highlighter-rouge">NA</code> values, functions to <a href="https://ourcodingclub.github.io/2017/02/08/funandloops.html" target="_blank">create your own <code class="highlighter-rouge">ggplot2</code> theme.</a></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Defining functions ----
# A custom ggplot2 function
</span><span class="n">theme_LPI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(){</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="o">=</span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">1</span><span class="p">),</span><span class="w">
          </span><span class="n">axis.text.y</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">12</span><span class="p">),</span><span class="w">
          </span><span class="n">axis.title.x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s2">"plain"</span><span class="p">),</span><span class="w">             
          </span><span class="n">axis.title.y</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s2">"plain"</span><span class="p">),</span><span class="w">             
          </span><span class="n">panel.grid.major.x</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">                                          
          </span><span class="n">panel.grid.minor.x</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
          </span><span class="n">panel.grid.minor.y</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
          </span><span class="n">panel.grid.major.y</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="w">  
          </span><span class="n">plot.margin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"cm"</span><span class="p">),</span><span class="w">
          </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">),</span><span class="w">
          </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s2">"italic"</span><span class="p">),</span><span class="w">          
          </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">                              
          </span><span class="n">legend.position</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><strong>Loading data</strong> - what do the data represent and where do they come from? Always include the file path in your code, so that you can track down your data later. Keep the file path structure simple so that it makes sense to everyone. No spaces in folder names and concise logical folder names can minimise potential future problems. Note that you define file paths differently on Mac and Windows laptops - if, for example, a Mac user has sent you code and you can’t load in the data, it might be because on a Mac you would use <code class="highlighter-rouge">"~/Work/LPI_analysis/LPIdatabase.csv"</code>, whereas on a Windows, the slashes go in the other direction - <code class="highlighter-rouge">"D:\Work\LPI_analysis\LPIdatabase.csv"</code>. If such problems arise, you can just change the type of slashes and the code should work as normal afterwards. Be careful when you are reorganising your folders and/or deleting folders - remember to update file paths, as otherwise you will get error messages telling you <code class="highlighter-rouge">R</code> can’t find the file anymore.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Load data ----
</span><span class="n">load</span><span class="p">(</span><span class="s2">"LPIdata_Feb2016.RData"</span><span class="p">)</span><span class="w">
</span><span class="n">load</span><span class="p">(</span><span class="s2">"puffin_GBIF.RData"</span><span class="p">)</span><span class="w">
</span><span class="c1"># Here we are using load() and RData files because the dataset is very big
# RData files are more compressed than .csv files
# Alternatively, here you can add your read.csv("your_filepath")
</span></code></pre>
</div>

<p><strong>The different sections of your analysis</strong> - what is the logical workflow of your analysis? Keep the order in which you tackle your analysis consistent. If this is code for an honours dissertation, a thesis chapter, or a manuscript, you can follow the same order in your script. Here is an example - if you copy these across to a script file, you’ll see the sections appear.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Formatting data ----
# Here you would add all your code for the formatting of your data
</span><span class="w">
</span><span class="c1"># Calculating summary statistics ----
</span><span class="w">
</span><span class="c1"># Examining the relationship between ... and ... ----
</span><span class="w">
</span><span class="c1"># Mixed effects models for species A ----
</span><span class="w">
</span><span class="c1"># Mixed effects models for species B ----
</span></code></pre>
</div>

<p><strong>The outputs of your analysis</strong> - Remember to keep your file path sensible not only when loading data in, but also when you are outputting files (e.g. <code class="highlighter-rouge">.Rdata</code>, <code class="highlighter-rouge">.csv</code> files and any figures you want saved). <code class="highlighter-rouge">.csv</code> files are more transferable and can be used across multiple platforms, whereas <code class="highlighter-rouge">.Rdata</code> files are more compressed and are quicker to work with. Saving graphs as <code class="highlighter-rouge">.pdf</code> files is better practice, since <code class="highlighter-rouge">.pdf</code> files are vector based and don’t decrease in quality when you zoom in or out. <code class="highlighter-rouge">.png</code> files, on the other hand, are easily inserted in text documents and presentations, so ideally you should save a <code class="highlighter-rouge">.pdf</code> and a <code class="highlighter-rouge">.png</code> file of your graph. It is also good practice to save image outputs in a subdirectory, e.g. <code class="highlighter-rouge">img</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">png</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"img/filename.png"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2000</span><span class="p">)</span><span class="w">  </span><span class="c1"># Note that png() uses pixel values for width and height
# The code for your graph goes here
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">  </span><span class="c1"># This tells R you are done with the plotting and it can save the file
</span><span class="w">
</span><span class="n">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"img/filename.png"</span><span class="p">,</span><span class="w">  </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">13.33</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">26.66</span><span class="p">)</span><span class="w">  </span><span class="c1"># pdf() uses inches
# The code for your graph goes here
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<p><strong>You might have noticed that when you create a section using four or more <code class="highlighter-rouge">#</code> or <code class="highlighter-rouge">-</code> at the end of a comment line, a little arrow appears in front of the comment. Another very useful feature of R Studio is that you can collapse and expand sections. This becomes especially useful when traversing a long script, just collapse the unwanted sections. If there is something you want to check out in the collapsed section, you can click the little arrow again to expand it.</strong></p>

<center> <img src="/img/outline4.png" alt="Img" style="width: 800px;" /> </center>

<p><strong>You can also go to <code class="highlighter-rouge">Edit/Folding/Collapse all</code> to collapse all sections - this is the outline of your script, and from here you can navigate to whichever section you need. <code class="highlighter-rouge">Expand all</code> displays all of the code you’ve written. Here is an example:</strong></p>

<center> <img src="/img/outline2.png" alt="Img" style="width: 800px;" /> </center>

<p><a name="syntax"></a></p>

<h3 id="2-following-a-coding-syntax-etiquette">2. Following a coding syntax etiquette</h3>

<h4 id="21-naming-files-and-objects">2.1. Naming files and objects.</h4>

<h4 id="there-are-only-two-hard-things-in-computer-science-cache-invalidation-and-naming-things---phil-karlton">“There are only two hard things in Computer Science: cache invalidation and naming things.” - Phil Karlton</h4>

<p>We’re not too familiar with cache invalidation, but we would definitely agree that naming things is hard, and going for a quick and easy solution, like calling your graphs <code class="highlighter-rouge">graph</code>, might cause trouble later!</p>

<p><strong>File names for scripts should be meaningful and end in <code class="highlighter-rouge">.R</code>. Avoid spaces and funky characters!!! They can cause trouble when uploading files to Github and in general when trying to locate files through certain file paths.</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">LPI_analysis_Apr_2017.R</span><span class="w">  </span><span class="c1"># Alright.
</span><span class="w">
</span><span class="n">yet_another_script.R</span><span class="w">  </span><span class="c1"># Bad. Took me hours to find the file when I needed it one year later.
</span></code></pre>
</div>

<p><strong>Object names should be concise and meaningful.</strong></p>

<p>Calling your data <code class="highlighter-rouge">data</code> might cause problems if you are doing multiple analyses at once / don’t clean your environment, and you keep using the same object name. But if you need an overwrittable universal object and you don’t need to keep lots of objects from each step of your analysis, sticking with the same object name might be useful.</p>

<p>Long object names are annoying to type - more letters = higher chance you’ll make a typo.</p>

<p>Variable and function names should be lowercase. <code class="highlighter-rouge">MinPrecip_august</code> is confusing to remember, <code class="highlighter-rouge">min.precip.aug</code> is a bit long, but informative and easier to type.</p>

<h5 id="--variable-names-should-be-nouns-eg-abundance-richness">- <strong>Variable names should be nouns.</strong> E.g. <code class="highlighter-rouge">abundance</code> <code class="highlighter-rouge">richness</code></h5>
<h5 id="--function-names-should-be-verbs-eg-calcsprichness">- <strong>Function names should be verbs.</strong> E.g. <code class="highlighter-rouge">calc.sp.richness</code></h5>
<h5 id="--use-an-underscore-to-separate-words-within-a-script-file-eg-lpi_analysis_apr_2017r">- <strong>Use an underscore to separate words within a script file.</strong> E.g. <code class="highlighter-rouge">LPI_analysis_Apr_2017.R</code></h5>
<h5 id="--use-a-dot-to-separate-words-within-objects-and-functions-eg-popchangem-for-the-object-that-stores-a-model-examining-population-change-and-calcsprichness-for-a-function">- <strong>Use a dot to separate words within objects and functions.</strong> E.g. <code class="highlighter-rouge">pop.change.m</code> for the object that stores a model examining population change, and <code class="highlighter-rouge">calc.sp.richness</code> for a function.</h5>
<h5 id="--the-preferred-form-for-variable-names-is-all-lower-case-letters-and-words-separated-with-dots-variablename">- <strong>The preferred form for variable names is all lower case letters and words separated with dots (<code class="highlighter-rouge">variable.name</code>).</strong></h5>

<h4 id="note-that-hadley-wickhams-style-guide-advises-to-use-underscores-to-separate-words-within-objects-eg-variable_name">Note that <a href="http://adv-r.had.co.nz/Style.html ">Hadley Wickham’s style guide</a> advises to use underscores to separate words within objects, e.g. <code class="highlighter-rouge">variable_name</code>.</h4>

<p>As pointed out by one of our readers, using dots to separate words in objects names has the potential to get confused with method dispatch mechanism.</p>

<p><strong>This way it’s clear what’s an object and what’s an external file. These are not strict rules - variable names like <code class="highlighter-rouge">variable_name</code> are also acceptable. The most important thing is to be consistent - choose one style of variable, object and file names, and stick with it!</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Variable names
</span><span class="w"> </span><span class="n">avg.clicks</span><span class="w">  </span><span class="c1"># Good.
</span><span class="w"> </span><span class="n">avg_clicks</span><span class="w">  </span><span class="c1"># Acceptable.
</span><span class="w"> </span><span class="n">avg_Clicks</span><span class="w">  </span><span class="c1"># Not that okay.
</span><span class="w">
</span><span class="c1"># Function names
</span><span class="w"> </span><span class="n">calculate.avg.clicks</span><span class="w">  </span><span class="c1"># This is what we are aiming for.
</span><span class="w"> </span><span class="n">CalculateAvgClicks</span><span class="w">  </span><span class="c1"># Not that bad, but mixing capital and lowercase letters can lead to typos
</span><span class="w"> </span><span class="n">calculate_avg_clicks</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">calculateAvgClicks</span><span class="w">  </span><span class="c1"># Bad.
</span></code></pre>
</div>

<h4 id="22-spacing">2.2 Spacing</h4>

<p><strong>Place spaces around all infix operators (<code class="highlighter-rouge">=</code>, <code class="highlighter-rouge">+</code>, <code class="highlighter-rouge">-</code>, <code class="highlighter-rouge">&lt;-</code>, etc.).</strong> The same rule applies when using <code class="highlighter-rouge">=</code> in function calls.
<strong>Always put a space after a comma, and never before.</strong></p>

<p>There are two exceptions to this rule (that we know of): <code class="highlighter-rouge">:</code> and <code class="highlighter-rouge">::</code> don’t need spaces around them, and one should not add spaces when defining coordinate systems in spatial objects.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="w">  </span><span class="c1"># Good
</span><span class="n">base</span><span class="o">::</span><span class="n">get</span><span class="w">  </span><span class="c1"># Good
</span><span class="n">dplyr</span><span class="o">::</span><span class="n">select</span><span class="w">  </span><span class="c1"># When you use `package_name::function_name` in your code like the example here, this means you are calling the function `select()` from the package `dplyr` - this way of using functions works without having loaded the package beforehand using `library(dplyr)`, but it's not very commonly used, since it's longer.
</span><span class="w">
</span><span class="n">crs.geo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CRS</span><span class="p">(</span><span class="s2">"+proj=longlat +ellps=WGS84 +datum=WGS84"</span><span class="p">)</span><span class="w">  </span><span class="c1"># geographical, datum WGS84
# Here we are creating an imaginary object with a geographical projection commonly used for the UK
</span></code></pre>
</div>

<p><strong>Don’t place a space before left parentheses, except in a function call.</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Good
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">

</span><span class="c1"># Bad
</span><span class="k">if</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="n">do</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><strong>Extra spacing (i.e., more than one space in a row) is ok if it improves alignment of equal signs or assignments (<code class="highlighter-rouge">&lt;-</code>).</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Sample code just to illustrate the point, no need to run the code at this point!
</span><span class="n">LPI_biome_summ</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">LPI_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">biome</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Group by biome
</span><span class="w">  </span><span class="n">summarise</span><span class="p">(</span><span class="n">populations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">(),</span><span class="w">   </span><span class="c1"># Create columns, number of populations
</span><span class="w">            </span><span class="n">mean_study_length_years</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">lengthyear</span><span class="p">),</span><span class="w">  </span><span class="c1"># mean study length
</span><span class="w">            </span><span class="n">max_lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">decimal_latitude</span><span class="p">),</span><span class="w">  </span><span class="c1"># max latitude
</span><span class="w">            </span><span class="n">min_lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">decimal_latitude</span><span class="p">),</span><span class="w">  </span><span class="c1"># max longitude
</span><span class="w">            </span><span class="n">dominant_sampling_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">which.max</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">sampling_method</span><span class="p">))),</span><span class="w">  </span><span class="c1"># modal sampling method
</span><span class="w">            </span><span class="n">dominant_units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">which.max</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">units</span><span class="p">))))</span><span class="w">  </span><span class="c1"># modal unit type
</span></code></pre>
</div>

<p><strong>Do not place spaces around code in parentheses or square brackets (unless there’s a comma, in which case see above).</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Good
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">diamonds</span><span class="p">[</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">

</span><span class="c1"># Bad
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">  </span><span class="c1"># No spaces around debug
</span><span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span><span class="w">   </span><span class="c1"># Needs a space after the comma
</span><span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="w"> </span><span class="p">,]</span><span class="w">  </span><span class="c1"># Space goes after comma not before
</span></code></pre>
</div>

<h4 id="23-curly-braces">2.3 Curly braces</h4>

<p>An opening curly brace should never go on its own line and should always be followed by a new line. A closing curly brace should always go on its own line, unless it’s followed by <code class="highlighter-rouge">else</code>.
<strong>Always indent the code inside curly braces.</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Good
</span><span class="w">
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">message</span><span class="p">(</span><span class="s2">"Y is negative"</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">x</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Bad
</span><span class="w">
</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">debug</span><span class="p">)</span><span class="w">
</span><span class="p">{</span><span class="n">message</span><span class="p">(</span><span class="s2">"Y is negative"</span><span class="p">)}</span><span class="w">

</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">y</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">x</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>It’s ok to leave very short statements on the same line:</p>
<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="n">message</span><span class="p">(</span><span class="s2">"Y is negative"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<h4 id="24-line-length">2.4 Line length</h4>

<p><strong>The official convention is to limit your code to 80 characters per line.</strong> Having to continuously scroll left and right can be annoying and confusing. Also, when you publish your code on Github, the scroll bar is all the way down, so to scroll right, you first need to scroll all the way down, scroll right, then scroll all the way up to wherever you want to be … unnecessary.</p>

<p><strong>How do you know what’s 80 characters though? RStudio can place a handy line in your editor as a reminder! Go to <code class="highlighter-rouge">Tools/Global Options/Code/Display/Show Margin/80 characters</code>.</strong> Sometimes it might make more sense for your code to be a bit longer than 80 characters, but in general code is easier to read if there is no need for continuous scrolling left and right, around 100 characters should work alright.</p>

<h5 id="when-using-pipes-keep-the-piping-operator--at-the-end-of-the-line-and-continue-your-pipe-on-a-new-line">When using pipes, keep the piping operator <code class="highlighter-rouge">%&gt;%</code> at the end of the line and continue your pipe on a new line.</h5>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Just an example of what a pipe could look like, no need to run the code at this stage.
</span><span class="n">LPI_long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">LPI_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">genus_species_id</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># group rows so that each group is one population
</span><span class="w">  </span><span class="n">mutate</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">maxyear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">year</span><span class="p">),</span><span class="w"> </span><span class="n">minyear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">year</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Create columns for the first and most recent years that data was collected
</span><span class="w">  </span><span class="n">mutate</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">lengthyear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxyear</span><span class="o">-</span><span class="n">minyear</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Create a column for the length of time data available
</span><span class="w">  </span><span class="n">mutate</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">scalepop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pop</span><span class="o">-</span><span class="nf">min</span><span class="p">(</span><span class="n">pop</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span><span class="o">-</span><span class="nf">min</span><span class="p">(</span><span class="n">pop</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Scale population trend data
</span><span class="w">  </span><span class="n">filter</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="nf">is.finite</span><span class="p">(</span><span class="n">scalepop</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">lengthyear</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Only keep rows with more than 5 years of data
</span><span class="w">  </span><span class="n">ungroup</span><span class="p">(</span><span class="n">.</span><span class="p">)</span><span class="w">  </span><span class="c1"># Remove any groupings you've greated in the pipe, not entirely necessary but it's better to be safe
</span></code></pre>
</div>

<h5 id="when-using-ggplot2-keep-the--at-the-end-of-the-line-and-continue-adding-on-layers-on-a-new-line">When using <code class="highlighter-rouge">ggplot2</code>, keep the <code class="highlighter-rouge">+</code> at the end of the line and continue adding on layers on a new line.</h5>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Just an example of what the code could look like, no need to run the code at this stage.
</span><span class="n">vulture_scatter</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">vultureITCR</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abundance</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Country.list</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">                                                
    </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Country.list</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">                    
    </span><span class="n">theme_my_own</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#EE7600"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#00868B"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">               
    </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#EE7600"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#00868B"</span><span class="p">),</span><span class="w">               
                        </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Croatia"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Italy"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">                 
    </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Griffon vulture abundance\n"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">                             
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"\nYear"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<h4 id="25-indentation">2.5 Indentation</h4>
<p>If a function definition runs over multiple lines, indent the second line to where the definition starts - you can check out the indentation in the <code class="highlighter-rouge">ggplot2</code> code above - when you click <code class="highlighter-rouge">Enter</code> after the <code class="highlighter-rouge">+</code> sign, the new line automatically gets indented.</p>

<p>Here is a before and after of a <code class="highlighter-rouge">ggplot2</code> figure code:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">()</span><span class="o">+</span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s2">"dotted"</span><span class="p">,</span><span class="n">colour</span><span class="o">=</span><span class="s2">"darkgrey"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cwa.sub</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Season</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">Total.Concentration</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_ribbon</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">preds2</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Season</span><span class="p">,</span><span class="w"> </span><span class="n">ymin</span><span class="o">=</span><span class="n">ploBT</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="o">=</span><span class="n">phiBT</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"#3cd0ea"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">preds2</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Season</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">Total.ConcentrationBT</span><span class="p">),</span><span class="n">colour</span><span class="o">=</span><span class="s2">"#3cd0ea"</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="o">+</span><span class="n">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Minimum Sea Ice Concentration"</span><span class="p">)</span><span class="o">+</span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Season"</span><span class="p">)</span><span class="o">+</span><span class="n">annotate</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="m">2012</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"p = "</span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="n">pval.cwa.sub</span><span class="p">,</span><span class="m">4</span><span class="p">)),</span><span class="n">size</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="o">+</span><span class="n">theme</span><span class="p">(</span><span class="n">legend.title</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="s2">"plain"</span><span class="p">,</span><span class="n">hjust</span><span class="o">=</span><span class="m">1</span><span class="p">),</span><span class="n">legend.text</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">18</span><span class="p">,</span><span class="n">angle</span><span class="o">=</span><span class="m">45</span><span class="p">),</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"bottom"</span><span class="p">,</span><span class="n">legend.key</span><span class="w"> </span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="n">axis.title.x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)),</span><span class="n">axis.title.y</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)),</span><span class="n">axis.text</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">16</span><span class="p">),</span><span class="n">panel.grid.minor</span><span class="o">=</span><span class="n">element_blank</span><span class="p">(),</span><span class="n">panel.grid.major</span><span class="o">=</span><span class="n">element_blank</span><span class="p">())</span><span class="w">

</span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dotted"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"darkgrey"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cwa.sub</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Season</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Total.Concentration</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_ribbon</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">preds2</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Season</span><span class="p">,</span><span class="w"> </span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ploBT</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phiBT</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#3cd0ea"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">preds2</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Season</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Total.ConcentrationBT</span><span class="p">),</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#3cd0ea"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Minimum Sea Ice Concentration"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Season"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">annotate</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2012</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"p = "</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">pval.cwa.sub</span><span class="p">,</span><span class="m">4</span><span class="p">)),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">45</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bottom"</span><span class="p">,</span><span class="w">
        </span><span class="n">legend.key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">margin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">margin</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)),</span><span class="w">
        </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">margin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">margin</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)),</span><span class="w">
        </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">16</span><span class="p">),</span><span class="w">
        </span><span class="n">panel.grid.minor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.major</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">())</span><span class="w">
</span><span class="c1"># The second version is much easier to read and there is no need to keep scrolling left and right.
</span></code></pre>
</div>

<p><a name="tidy"></a></p>

<h3 id="3-tidying-up-old-scripts-and-data-frames">3. Tidying up old scripts and data frames</h3>

<p>It’s best to start following a sensible coding etiquette from the very beginning, but realistically we are often in a hurry, we want to code quickly and even if we know we are not following best practices, we still go ahead, because we are thinking of our short-term goals - getting it done, as opposed to the more long-term goals of having a sensible and reproducible record of our analysis. As we are writing this tutorial, we are just as guilty as everyone else of having messy scripts, missing spaces around <code class="highlighter-rouge">=</code>, etc. But it’s important to try to be consistent with your coding, and once you get into the habit of it, it hopefully won’t seem “just like one extra thing to do”.</p>

<h4 id="what-if-you-want-to-make-your-old-code-neater"><strong>What if you want to make your old code neater?</strong></h4>

<p>That’s a lot of spaces you might need to add in… First, you could try using RStudio to format the code for you - click on <code class="highlighter-rouge">Code/Reformat code</code> and see what happens - you will get all the spaces in, but R puts the code on a new line after each comma, too many lines! You can try this instead: (<strong>back up your scripts before you start any experimenting!!!</strong>)</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Reformat your old code to add in spaces and limit line length
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"formatR"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s2">"formatR"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Set working directory to wherever your messy script is
</span><span class="n">tidy_source</span><span class="p">(</span><span class="s2">"messy_script_2017-02-25.R"</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"tidy_script_2017-02-25.R"</span><span class="p">,</span><span class="w"> </span><span class="n">width.cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="c1"># If you don't specify file = "new_script.R", your script will get overwritten, dangerous!
# If you don't specify a width cutoff point, tidy_source just adds in the spaces
# 100 characters seems like a reasonable cutoff point
</span><span class="w">
</span><span class="c1"># Reformat all the scripts in a directory
# Set your working directory to wherever your messy scripts are
</span><span class="w">
</span><span class="c1"># IMPORTANT this will override script files, so make a duplicate back up folder, in case tidy_dir messes up
</span><span class="n">tidy_dir</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">"whatever/your/path/is"</span><span class="p">,</span><span class="w"> </span><span class="n">recursive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="c1"># recursive	- whether to look for R scripts in subdirectories of the directory specified under path
</span></code></pre>
</div>

<h4 id="renaming-old-objects-and-variables">Renaming old objects and variables</h4>

<p>If, like us, you find yourself having to use a script from before you knew any better, you might have objects with really uninformative, unnecesarily hard to type names. There is an easy fix to that - just like in most text editors, you can <code class="highlighter-rouge">Find</code> and <code class="highlighter-rouge">Replace</code> words, in our case object names. You can type up the object whose name you want to change, then add the new one, and replace either individual occurrences, or all of the occasions when the object name is mentioned. You can also select lines of code and only rename the object in that part of the code - careful that you have clicked on <code class="highlighter-rouge">In selection</code>, as otherwise the object name will be replaced in the entire script, despite you having selected only some of the lines.</p>

<center> <img src="/img/replace.png" alt="Img" style="width: 800px;" /> </center>

<p><strong>If you want to rename your variable names, that’s quickly done, too.</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="nf">names</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"."</span><span class="p">,</span><span class="w"> </span><span class="s2">"_"</span><span class="p">,</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">dataframe</span><span class="p">),</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="c1"># This code takes all of the variable names in the imaginary dataset `dataframe` and replaces `.` with `_`
# Depending on the naming style you are using, you might want to go the other way around and use `.` in all variable names
</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tolower</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">dataframe</span><span class="p">))</span><span class="w">
</span><span class="c1"># This code makes all of the variable names in the imaginary dataset lowercase
</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)[</span><span class="n">colnames</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'Old_Complicated_Name'</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'new.simple.name'</span><span class="w">
</span><span class="c1"># Renaming an individual column in the imaginary dataset
</span></code></pre>
</div>

<h3 id="rstudio-addins">RStudio addins:</h3>

<p>RStudio addins are available for the newest version of RStudio and add some functionality to RStudio using point and click menus. After you have installed certain addins, you can access them by clicking on <code class="highlighter-rouge">Addins</code>, which is under the <code class="highlighter-rouge">Profile</code> and <code class="highlighter-rouge">Tools</code> bar in the RStudio menu. To get a full list of RStudio plugins, run:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s1">'addinslist'</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>When you click on <code class="highlighter-rouge">Addins/Browse RStudio Addins</code> you will see the list of addins and the links to their Github repos.</p>

<p><strong>Boxes around introductory sections of scripts have become a trendy addition to script files, definitely not an essential component, but if that appeals to you, you can add a box using this plugin, saving you the time of typing up many hashtags.</strong></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="c1"># Insert a box around the introductory section of your script
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"devtools"</span><span class="p">)</span><span class="w">
</span><span class="n">devtools</span><span class="o">::</span><span class="n">install_github</span><span class="p">(</span><span class="s2">"ThinkRstat/littleboxes"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Afterwards select your introductory comments, click on Addins/ Little boxes and the box appears!
# Note that if you are also reformatting your code using formatR, reformat the code first, then add the box.
# formatR messes up these boxes otherwise!
</span></code></pre>
</div>

<center> <img src="/img/boxes.png" alt="Img" style="width: 800px;" /> </center>

<h3 id="applying-the-coding-etiquette-to-a-real-analysis">Applying the coding etiquette to a real analysis</h3>

<h4 id="now-that-you-have-been-through-the-coding-etiquette-you-can-have-a-go-at-applying-what-youve-learned-by-following-our-tutorial-on-quantifying-population-change-and-visualising-species-occurrence-and-writing-a-clear-informative-well-structured-script-as-you-go-along">Now that you have been through the coding etiquette, you can have a go at applying what you’ve learned by following our tutorial on <a href="https://ourcodingclub.github.io/2017/03/20/seecc.html" target="_blank">Quantifying population change and visualising species occurrence</a>, and writing a clear, informative, well-structured script as you go along.</h4>

<hr />

<hr />

<h4 id="check-out-our-useful-links-page-where-you-can-find-loads-of-guides-and-cheatsheets">Check out our <a href="https://ourcodingclub.github.io/links/" target="_blank">Useful links</a> page where you can find loads of guides and cheatsheets.</h4>

<h4 id="if-you-have-any-questions-about-completing-this-tutorial-please-contact-us-on-ourcodingclubgmailcom">If you have any questions about completing this tutorial, please contact us on ourcodingclub@gmail.com</h4>

<h4 id="we-would-love-to-hear-your-feedback-on-the-tutorial-whether-you-did-it-in-the-classroom-or-online"><a href="https://www.surveymonkey.co.uk/r/8YBXTMT" target="_blank">We would love to hear your feedback on the tutorial, whether you did it in the classroom or online!</a></h4>

<p>Our coding etiquette was developed with the help of <a href="http://adv-r.had.co.nz/Style.html" target="_blank">Hadley Whickham’s R Style Guide</a>.</p>

<ul class="social-icons">
	<li>
		<h3>
			<a href="https://twitter.com/our_codingclub" target="_blank">&nbsp;Follow our coding adventures on Twitter! <i class="fa fa-twitter"></i></a>
		</h3>
	</li>
</ul>

<h3 id="subscribe-to-our-mailing-list">  Subscribe to our mailing list:</h3>
<div class="container">
	<div class="block">
        <!-- subscribe form start -->
		<div class="form-group">
			<form action="https://getsimpleform.com/messages?form_api_token=de1ba2f2f947822946fb6e835437ec78" method="post">
			<div class="form-group">
				<input type="text" class="form-control" name="Email" placeholder="Email" required="" />
			</div>
			<div>
                        	<button class="btn btn-default" type="submit">Subscribe</button>
                    	</div>
                	</form>
		</div>
	</div>
</div>
</p>
          </div>
        </div><!-- .col-md-7 close -->
      </div>
    </div>
  </section>
</div>
<p class="center-text" style="padding: 30px;">
  <a href="/blog">Back to blog</a>
</p>











    <!-- footer Start -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="footer-manu">
          <ul>
            <li><a href="/consortium">About Us</a></li>
        <!--    <li><a href="/contact">Contact us</a></li>-->
          </ul>
        </div>
        <p>Content by <a href="/about/">..</a>.</p>
        <p>Copyright &copy; Design &amp; Developed by <a href="http://www.themefisher.com">Themefisher</a>. All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>

    

    </body>
</html>

